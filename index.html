<html>
<body>
  <canvas id="canvas"></canvas>
  <script src="js/three.min.js"></script>
  <script src="js/TrackballControls.js"></script>
  <script src="js/CanvasInput.js"></script>
  <script>
  var camera, controls, scene, renderer;

  init();
  animate();

  function init(){
    camera = new THREE.PerspectiveCamera(45, window.innerWidth/ window.innerHeight, 1, 1000);
    camera.position.z = 5;
    camera.position.y = 50;
    camera.position.x = 0;

    controls = new THREE.TrackballControls( camera );
    controls.addEventListener('change', render);

    scene = new THREE.Scene();

    // var geometry = new THREE.IcosahedronGeometry(100);
    // var material = new THREE.MeshNormalMaterial();

    var size = 14, step = 1;
    var geometry = new THREE.Geometry();
    var axes = new THREE.Geometry();
    var material = new THREE.LineBasicMaterial({color: "green"});
    var axismaterial = new THREE.LineBasicMaterial({color: "red"});
    for (var i = -size; i <= size; i += step){
      if(i == 0){
        axes.vertices.push(new THREE.Vector3(-size, -0.04, i));
        axes.vertices.push(new THREE.Vector3(size, -0.04, i));
        axes.vertices.push(new THREE.Vector3(i, -0.04, -size));
        axes.vertices.push(new THREE.Vector3(i, -0.04, size));
      } else {
        geometry.vertices.push(new THREE.Vector3(-size, -0.04, i));
        geometry.vertices.push(new THREE.Vector3(size, -0.04, i));
        geometry.vertices.push(new THREE.Vector3(i, -0.04, -size));
        geometry.vertices.push(new THREE.Vector3(i, -0.04, size));
      }
    }
    var line = new THREE.Line(geometry, material, THREE.LinePieces);
    var lineaxes = new THREE.Line(axes, axismaterial, THREE.LinePieces);


    //Curve test
    var x = -size;
    var func;
    var points = [];
    for (var i = -size; i <= size; i+= step){
      //Somehow the plane is "backwards", the positive y-cordinate is negative
      func = -(x*x*x);
      points[i+size] = new THREE.Vector3(x,0,func);
      x++;
    }
    var spline = new THREE.SplineCurve3(points);

      var geometry2 = new THREE.Geometry();
      var splinePoints = spline.getPoints(100);

      var material2 = new THREE.LineBasicMaterial( { color: "white" } );
      console.log(points.length);
      for(var i = 0; i < splinePoints.length; i++){
            geometry2.vertices.push(splinePoints[i]);
      }

      var line2 = new THREE.Line(geometry2, material2);

    scene.add(line2);
    scene.add(line);
    scene.add(lineaxes);

    var input = new CanvasInput({
      canvas: document.getElementById("canvas")
    });
    var canvas = document.getElementById("canvas");
    renderer = new THREE.WebGLRenderer({canvas: canvas});
    renderer.setSize(window.innerWidth, window.innerHeight)
    document.body.appendChild(renderer.domElement);
  }

  function animate(){
    requestAnimationFrame( animate );
    controls.update();
  }

  function render(){
    renderer.render( scene, camera );
  }

  </script>
</body>
</html>
